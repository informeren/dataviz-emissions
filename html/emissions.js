(function(e){function s(e,t,n,r,i,s){var o="#"+e+"-"+t,u="chart-"+e+"-"+t;if(n!=""){o+="-"+n;u+="-"+n}d3.select(o).insert("svg").attr("width",r+s.left+s.right).attr("height",i+s.top+s.bottom).append("g").attr("transform","translate("+s.left+","+s.top+")").attr("id",u).append("g").attr("class","y axis")}function o(t,n,r,i,s,o){var u="#chart-"+t+"-"+r,a="#legend-"+t+"-"+r;if(i!=""){u+="-"+i;a+="-"+i}var l=d3.scale.ordinal().rangeRoundBands([0,s],.3),c=d3.scale.linear().range([o,0]),h=d3.svg.axis().scale(l).innerTickSize(0).outerTickSize(0).orient("bottom"),p=d3.svg.axis().scale(c).innerTickSize(0).outerTickSize(0).tickPadding(0).orient("left").ticks(5,"d");d3.json("./emissions/"+t+"/"+n+".json",function(n,s){if(n)return console.warn(n);var d=new Array;e.each(s,function(e,n){switch(t){case"type":d.push({key:e,value:n[r]});break;case"source":d.push({key:e,value:n[r][i]})}});var v=d3.max(d,function(e){return e.value});l.domain(d.map(function(e){return e.key}));c.domain([0,v]);var m=d3.select(u),g=m.selectAll("rect.bar").data(d);g.enter().append("rect").attr("class","bar");g.exit().transition().duration(300).ease("exp").attr("width",0).remove();g.transition().duration(300).ease("quad").attr("x",function(e){return l(e.key)}).attr("y",function(e){return c(e.value)}).attr("height",function(e){return o-c(e.value)}).attr("width",l.rangeBand());m.append("g").attr("class","x axis").attr("transform","translate(0,"+o+")").call(h).selectAll(".x.axis text").attr("transform","rotate(90)translate(14, -6)");m.select(".y.axis").transition().duration(300).ease("exp").call(p).selectAll(".y.axis text").text(function(t){e.each([1e6,1e5,1e4,1e3],function(n,r){if(v>r){t/=r;e(a).html("Enhed: "+f(r)+" ton");return!1}e(a).html("Enhed: 1 ton")});return t})})}function u(e,t,n,r,i){var s="#"+e+"-"+t,o="chart-"+e+"-"+t;d3.select(s).insert("svg").attr("width",n+i.left+i.right).attr("height",r+i.top+i.bottom).append("g").attr("transform","translate("+i.left+","+i.top+")").attr("id",o)}function a(t,n,r,i,s){var o="#chart-"+t+"-"+r;d3.json("./emissions/"+t+"/"+n+".json",function(t,n){if(t)return console.warn(t);var i=0;e.each(n[2011],function(e,t){i+=parseInt(t.co2)});var s=parseInt(n[2011][r].co2),u=Math.round(s/i*100),a=[u],f=d3.select(o),l=f.selectAll("text").data(a);l.enter().append("text").text(0).attr("x",20).attr("y",10).attr("class","txt");l.transition().duration(300).tween("text",function(e){var t=d3.interpolate(this.textContent.replace(/\s%/ig,""),e);return function(e){this.textContent=Math.round(t(e))+" %"}})})}function f(e){e+="";var t=/(\d+)(\d{3})/;while(t.test(e))e=e.replace(t,"$1.$2");return e}var t=220;e(window).width()<400&&(t=300);var n=new Object;n.type={margin:{top:15,right:5,bottom:32,left:32},width:t-32-5,height:153};n.source={margin:{top:10,right:5,bottom:24,left:32},width:t-32-5,height:66};n.industry={margin:{top:10,right:10,bottom:10,left:10},width:119,height:119};var r=new Array;e.each(["co2","ch4","no","gwp"],function(e,t){r.push({type:"type",municipality:"all",filter1:t,filter2:"",width:n.type.width,height:n.type.height,margin:n.type.margin})});e.each(["fossil_fuels","unrelated","renewables"],function(t,i){e.each(["co2","ch4","no","gwp"],function(e,t){r.push({type:"source",municipality:"all",filter1:i,filter2:t,width:n.source.width,height:n.source.height,margin:n.source.margin})})});r.splice(12,1);var i=new Array;e.each(["agriculture","rawmaterials","industry","utilities","construction","culture"],function(e,t){i.push({type:"industry",municipality:"all",filter:t,width:n.industry.width,height:n.industry.height,margin:n.industry.margin})});e(function(){e("#filter").change(function(){var t=this.value;e.each(i,function(e,n){a(n.type,t,n.filter,n.width,n.height)})});e.each(i,function(e,t){u(t.type,t.filter,t.width,t.height,t.margin)});e("#filter").change()})})(jQuery);+function(e){"use strict";var t=function(n,r){this.$element=e(n);this.options=e.extend({},t.DEFAULTS,r);this.transitioning=null;this.options.parent&&(this.$parent=e(this.options.parent));this.options.toggle&&this.toggle()};t.DEFAULTS={toggle:!0};t.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"};t.prototype.show=function(){if(this.transitioning||this.$element.hasClass("in"))return;var t=e.Event("show.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var r=n.data("bs.collapse");if(r&&r.transitioning)return;n.collapse("hide");r||n.data("bs.collapse",null)}var i=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[i](0);this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[i]("auto");this.transitioning=0;this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var o=e.camelCase(["scroll",i].join("-"));this.$element.one(e.support.transition.end,e.proxy(s,this)).emulateTransitionEnd(350)[i](this.$element[0][o])};t.prototype.hide=function(){if(this.transitioning||!this.$element.hasClass("in"))return;var t=e.Event("hide.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight;this.$element.addClass("collapsing").removeClass("collapse").removeClass("in");this.transitioning=1;var r=function(){this.transitioning=0;this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};if(!e.support.transition)return r.call(this);this.$element[n](0).one(e.support.transition.end,e.proxy(r,this)).emulateTransitionEnd(350)};t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("bs.collapse"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n);!i&&s.toggle&&n=="show"&&(n=!n);i||r.data("bs.collapse",i=new t(this,s));typeof n=="string"&&i[n]()})};e.fn.collapse.Constructor=t;e.fn.collapse.noConflict=function(){e.fn.collapse=n;return this};e(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i),o=s.data("bs.collapse"),u=o?"toggle":n.data(),a=n.attr("data-parent"),f=a&&e(a);if(!o||!o.transitioning){f&&f.find('[data-toggle=collapse][data-parent="'+a+'"]').not(n).addClass("collapsed");n[s.hasClass("in")?"addClass":"removeClass"]("collapsed")}s.collapse(u)})}(jQuery);+function(e){"use strict";function i(r){e(t).remove();e(n).each(function(){var t=s(e(this)),n={relatedTarget:this};if(!t.hasClass("open"))return;t.trigger(r=e.Event("hide.bs.dropdown",n));if(r.isDefaultPrevented())return;t.removeClass("open").trigger("hidden.bs.dropdown",n)})}function s(t){var n=t.attr("data-target");if(!n){n=t.attr("href");n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")}var r=n&&e(n);return r&&r.length?r:t.parent()}var t=".dropdown-backdrop",n="[data-toggle=dropdown]",r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.prototype.toggle=function(t){var n=e(this);if(n.is(".disabled, :disabled"))return;var r=s(n),o=r.hasClass("open");i();if(!o){"ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",i);var u={relatedTarget:this};r.trigger(t=e.Event("show.bs.dropdown",u));if(t.isDefaultPrevented())return;r.toggleClass("open").trigger("shown.bs.dropdown",u);n.focus()}return!1};r.prototype.keydown=function(t){if(!/(38|40|27)/.test(t.keyCode))return;var r=e(this);t.preventDefault();t.stopPropagation();if(r.is(".disabled, :disabled"))return;var i=s(r),o=i.hasClass("open");if(!o||o&&t.keyCode==27){t.which==27&&i.find(n).focus();return r.click()}var u=" li:not(.divider):visible a",a=i.find("[role=menu]"+u+", [role=listbox]"+u);if(!a.length)return;var f=a.index(a.filter(":focus"));t.keyCode==38&&f>0&&f--;t.keyCode==40&&f<a.length-1&&f++;~f||(f=0);a.eq(f).focus()};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this));typeof t=="string"&&i[t].call(n)})};e.fn.dropdown.Constructor=r;e.fn.dropdown.noConflict=function(){e.fn.dropdown=o;return this};e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,r.prototype.toggle).on("keydown.bs.dropdown.data-api",n+", [role=menu], [role=listbox]",r.prototype.keydown)}(jQuery);