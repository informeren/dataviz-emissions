(function(e){function n(e,t,n,i){var s="#"+e+"-"+t,o="chart-"+e+"-"+t;if(n!=""){s+="-"+n;o+="-"+n}d3.select(s).insert("svg").attr("width",i.width+i.margin.left+i.margin.right).attr("height",i.height+i.margin.top+i.margin.bottom).append("g").attr("transform","translate("+i.margin.left+","+i.margin.top+")").attr("id",o).append("g").attr("class","y axis");r(e,"all",t,n,i)}function r(t,n,r,i,s){var o=s.width,u=s.height,a="#chart-"+t+"-"+r;i!=""&&(a+="-"+i);var f=d3.scale.ordinal().rangeRoundBands([0,o],.3),l=d3.scale.linear().range([u,0]),c=d3.svg.axis().scale(f).innerTickSize(0).outerTickSize(0).orient("bottom"),h=d3.svg.axis().scale(l).innerTickSize(0).outerTickSize(0).tickPadding(0).orient("left").ticks(5,"d");d3.json("./emissions/"+t+"/"+n+".json",function(n,s){if(n)return console.warn(n);var o=new Array;e.each(s,function(e,n){switch(t){case"type":o.push({key:e,value:n[r]});break;case"source":o.push({key:e,value:n[r][i]})}});f.domain(o.map(function(e){return e.key}));l.domain([0,d3.max(o,function(e){return e.value})]);var p=d3.select(a),d=p.selectAll("rect.bar").data(o);d.enter().append("rect").attr("class","bar");d.exit().transition().duration(300).ease("exp").attr("width",0).remove();d.transition().duration(300).ease("quad").attr("x",function(e){return f(e.key)}).attr("y",function(e){return l(e.value)}).attr("height",function(e){return u-l(e.value)}).attr("width",f.rangeBand());p.append("g").attr("class","x axis").attr("transform","translate(0,"+u+")").call(c).selectAll(".x.axis text").attr("transform","rotate(90)translate(14, -6)");p.select(".y.axis").transition().duration(300).ease("exp").call(h).selectAll(".y.axis text").text(function(e){return e/1e3})})}var t=new Object;t.type={margin:{top:15,right:5,bottom:32,left:32},width:183,height:153};t.source={margin:{top:10,right:5,bottom:24,left:32},width:183,height:66};e(function(){e("#municipality").change(function(){r("type",this.value,"co2","",t.type);r("type",this.value,"ch4","",t.type);r("type",this.value,"no","",t.type);r("type",this.value,"gwp","",t.type);r("source",this.value,"fossil_fuels","co2",t.source);r("source",this.value,"unrelated","co2",t.source);r("source",this.value,"fossil_fuels","ch4",t.source);r("source",this.value,"unrelated","ch4",t.source);r("source",this.value,"renewables","ch4",t.source);r("source",this.value,"fossil_fuels","no",t.source);r("source",this.value,"unrelated","no",t.source);r("source",this.value,"renewables","no",t.source);r("source",this.value,"fossil_fuels","gwp",t.source);r("source",this.value,"unrelated","gwp",t.source);r("source",this.value,"renewables","gwp",t.source)});n("type","co2","",t.type);n("type","ch4","",t.type);n("type","no","",t.type);n("type","gwp","",t.type);n("source","fossil_fuels","co2",t.source);n("source","unrelated","co2",t.source);n("source","fossil_fuels","ch4",t.source);n("source","unrelated","ch4",t.source);n("source","renewables","ch4",t.source);n("source","fossil_fuels","no",t.source);n("source","unrelated","no",t.source);n("source","renewables","no",t.source);n("source","fossil_fuels","gwp",t.source);n("source","unrelated","gwp",t.source);n("source","renewables","gwp",t.source)})})(jQuery);+function(e){"use strict";var t=function(n,r){this.$element=e(n);this.options=e.extend({},t.DEFAULTS,r);this.transitioning=null;this.options.parent&&(this.$parent=e(this.options.parent));this.options.toggle&&this.toggle()};t.DEFAULTS={toggle:!0};t.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"};t.prototype.show=function(){if(this.transitioning||this.$element.hasClass("in"))return;var t=e.Event("show.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var r=n.data("bs.collapse");if(r&&r.transitioning)return;n.collapse("hide");r||n.data("bs.collapse",null)}var i=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[i](0);this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[i]("auto");this.transitioning=0;this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var o=e.camelCase(["scroll",i].join("-"));this.$element.one(e.support.transition.end,e.proxy(s,this)).emulateTransitionEnd(350)[i](this.$element[0][o])};t.prototype.hide=function(){if(this.transitioning||!this.$element.hasClass("in"))return;var t=e.Event("hide.bs.collapse");this.$element.trigger(t);if(t.isDefaultPrevented())return;var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight;this.$element.addClass("collapsing").removeClass("collapse").removeClass("in");this.transitioning=1;var r=function(){this.transitioning=0;this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};if(!e.support.transition)return r.call(this);this.$element[n](0).one(e.support.transition.end,e.proxy(r,this)).emulateTransitionEnd(350)};t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("bs.collapse"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n);!i&&s.toggle&&n=="show"&&(n=!n);i||r.data("bs.collapse",i=new t(this,s));typeof n=="string"&&i[n]()})};e.fn.collapse.Constructor=t;e.fn.collapse.noConflict=function(){e.fn.collapse=n;return this};e(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i),o=s.data("bs.collapse"),u=o?"toggle":n.data(),a=n.attr("data-parent"),f=a&&e(a);if(!o||!o.transitioning){f&&f.find('[data-toggle=collapse][data-parent="'+a+'"]').not(n).addClass("collapsed");n[s.hasClass("in")?"addClass":"removeClass"]("collapsed")}s.collapse(u)})}(jQuery);+function(e){"use strict";function i(r){e(t).remove();e(n).each(function(){var t=s(e(this)),n={relatedTarget:this};if(!t.hasClass("open"))return;t.trigger(r=e.Event("hide.bs.dropdown",n));if(r.isDefaultPrevented())return;t.removeClass("open").trigger("hidden.bs.dropdown",n)})}function s(t){var n=t.attr("data-target");if(!n){n=t.attr("href");n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")}var r=n&&e(n);return r&&r.length?r:t.parent()}var t=".dropdown-backdrop",n="[data-toggle=dropdown]",r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.prototype.toggle=function(t){var n=e(this);if(n.is(".disabled, :disabled"))return;var r=s(n),o=r.hasClass("open");i();if(!o){"ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",i);var u={relatedTarget:this};r.trigger(t=e.Event("show.bs.dropdown",u));if(t.isDefaultPrevented())return;r.toggleClass("open").trigger("shown.bs.dropdown",u);n.focus()}return!1};r.prototype.keydown=function(t){if(!/(38|40|27)/.test(t.keyCode))return;var r=e(this);t.preventDefault();t.stopPropagation();if(r.is(".disabled, :disabled"))return;var i=s(r),o=i.hasClass("open");if(!o||o&&t.keyCode==27){t.which==27&&i.find(n).focus();return r.click()}var u=" li:not(.divider):visible a",a=i.find("[role=menu]"+u+", [role=listbox]"+u);if(!a.length)return;var f=a.index(a.filter(":focus"));t.keyCode==38&&f>0&&f--;t.keyCode==40&&f<a.length-1&&f++;~f||(f=0);a.eq(f).focus()};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this));typeof t=="string"&&i[t].call(n)})};e.fn.dropdown.Constructor=r;e.fn.dropdown.noConflict=function(){e.fn.dropdown=o;return this};e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,r.prototype.toggle).on("keydown.bs.dropdown.data-api",n+", [role=menu], [role=listbox]",r.prototype.keydown)}(jQuery);